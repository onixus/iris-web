<!DOCTYPE html>
<html lang="en">
<head>

	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<title>IRIS - {% block title %}Case{% endblock %} {% if session['current_case'].case_id %}| {{ session['current_case'].case_name }}  {% endif %} </title>
	<meta content='width=device-width, initial-scale=1.0, shrink-to-fit=no' name='viewport' />
	<link rel="icon" href="/static/assets/img/logo.ico" type="image/x-icon"/>
	{% if demo_domain %}
		<script defer data-domain="{{demo_domain}}" src="https://analytics.dfir-iris.org/js/plausible.js"></script>
	{% endif %}
	<!-- Fonts and icons -->
	<script src="/static/assets/js/plugin/webfont/webfont.min.js"></script>
	<script>
		WebFont.load({
			custom: {"families":["Lato:300,400,700,900", "Flaticon", "Font Awesome 5 Solid", "Font Awesome 5 Regular", "Font Awesome 5 Brands", "simple-line-icons"],
			urls: ['/static/assets/css/fonts.css']},
			active: function() {
				sessionStorage.fonts = true;
			}
		});
	</script>

	<!-- CSS Files -->
	<link rel="stylesheet" href="/static/assets/css/bootstrap.min.css">
	<link rel="stylesheet" href="/static/assets/css/atlantis.css">
	<link rel="stylesheet" href="/static/assets/css/suggestags.css">
	<link rel="stylesheet" href="/static/assets/css/bootstrap-select.min.css">

    <!-- Specific CSS goes HERE -->
    {% block stylesheets %}{% endblock stylesheets %}

	{% set _theme = current_user.effective_theme if current_user.is_authenticated else 'light' %}

	<!-- Theme CSS -->
	{% if _theme == 'dark' %}
		<link rel="stylesheet" href="/static/assets/css/dark-theme.css" id="iris-theme-css">
	{% elif _theme == 'pride' %}
		<link rel="stylesheet" href="/static/assets/css/pride-theme.css" id="iris-theme-css">
	{% else %}
		<link rel="stylesheet" href="" id="iris-theme-css"><!-- light: no extra CSS -->
	{% endif %}

	<style>
		.iris-locale-btn.active, .iris-theme-btn.active {
			border-color: rgba(255,255,255,0.9) !important;
			color: #fff !important;
			background: rgba(255,255,255,0.15) !important;
			font-weight: 700;
		}
	</style>
</head>
<body class="theme-{{ _theme }}">
	<div class="wrapper {% block layout %}{% endblock layout %} {% include 'includes/sidebar_handler.html' %}">


		{% block content %}{% endblock content %}

		{% include 'includes/quick-sidebar.html' %}
		{% include 'includes/datastore-sidebar.html' %}
		<div id="minimized_modal_box" class="col-10 col-xs-11 col-sm-4 minimized_modal shadow-lg" style="display:none;" title="Maximize modal" onclick="modal_maximize();">
			<div class="row mt-3 mb-3">
				<div class="col-10 d-flex">
					<span data-notify="title" id="minimized_modal_title" class="align-self-center"></span>
				</div>
				<div class="col-1 d-flex" style="padding-left:5px;">
					<i class="fa-solid fa-arrow-up-right-dots align-self-center"></i>
				</div>
			</div>
		</div>
		<div id="modal_md_helper"></div>
	</div>

	<!--   Core JS Files   -->
	<script src="/static/assets/js/core/jquery.3.2.1.min.js"></script>
	<script src="/static/assets/js/core/popper.min.js"></script>
	<script src="/static/assets/js/core/bootstrap.min.js"></script>
	<script src="/static/assets/js/plugin/tagsinput/suggesttag.js"></script>

	<!-- jQuery UI -->
	<script src="/static/assets/js/plugin/jquery-ui-1.12.1.custom/jquery-ui.min.js"></script>
	<script src="/static/assets/js/plugin/jquery-ui-touch-punch/jquery.ui.touch-punch.min.js"></script>

	<!-- jQuery Scrollbar -->
	<script src="/static/assets/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js"></script>

	<!-- Datatables -->
	<script src="/static/assets/js/plugin/datatables/datatables.min.js"></script>

	<!-- Bootstrap Notify -->
	<script src="/static/assets/js/plugin/bootstrap-notify/bootstrap-notify.min.js"></script>
	<script src="/static/assets/js/plugin/sweetalert/sweetalert.min.js"></script>
	<script src="/static/assets/js/plugin/select/bootstrap-select.min.js"></script>
	<script src="/static/assets/js/plugin/select/ajax-bootstrap-picker.js"></script>

	<!-- HTML 2 Canvas -->
	<script src="/static/assets/js/plugin/html2canvas/html2canvas.min.js"></script>

	<!-- Atlantis JS -->
	<script src="/static/assets/js/atlantis.min.js"></script>

	<script src="/static/assets/js/plugin/ace/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
	<script src="/static/assets/js/plugin/ace/src-noconflict/ext-language_tools.js" type="text/javascript"
    charset="utf-8"></script>

	<!-- IRIS i18n â€” must load before common.js -->
	<script src="/static/assets/js/iris/i18n.js"></script>
	<script>
		(function () {
			var saved = localStorage.getItem('iris_locale') || 'en';
			document.documentElement.setAttribute('lang', saved);
			document.addEventListener('DOMContentLoaded', function () {
				document.querySelectorAll('.iris-locale-btn').forEach(function (btn) {
					btn.classList.toggle('active', btn.dataset.locale === saved);
				});
			});
		}());
	</script>

	<script src="/static/assets/js/iris/common.js"></script>
	<script src="/static/assets/js/iris/datastore.js"></script>

	<script src="/static/assets/js/core/crypto.core.js"></script>
	<script src="/static/assets/js/core/crypto.md5.js"></script>
	<script src="/static/assets/js/plugin/xss/xss.js"></script>
	<script src="/static/assets/js/plugin/showdown/showdown.min.js" type="text/javascript" charset="utf-8"></script>

	<!-- Theme switcher JS -->
	<script>
		var IRIS_CURRENT_THEME = '{{ _theme }}';

		var THEME_CSS = {
			light: '',
			dark:  '/static/assets/css/dark-theme.css',
			pride: '/static/assets/css/pride-theme.css'
		};

		function iris_set_theme(theme) {
			if (!THEME_CSS.hasOwnProperty(theme)) return;
			document.getElementById('iris-theme-css').href = THEME_CSS[theme];
			document.body.classList.remove('theme-light', 'theme-dark', 'theme-pride');
			document.body.classList.add('theme-' + theme);
			document.querySelectorAll('.iris-theme-btn').forEach(function(btn) {
				btn.classList.toggle('active', btn.dataset.theme === theme);
			});
			IRIS_CURRENT_THEME = theme;
			$.ajax({
				url: '/profile/theme',
				type: 'POST',
				contentType: 'application/json',
				data: JSON.stringify({ theme: theme }),
				error: function() { console.warn('[theme] Failed to save theme preference'); }
			});
		}

		document.addEventListener('DOMContentLoaded', function() {
			document.querySelectorAll('.iris-theme-btn').forEach(function(btn) {
				btn.classList.toggle('active', btn.dataset.theme === IRIS_CURRENT_THEME);
			});
		});
	</script>

	<!-- Specific JS goes HERE -->
    {% block javascripts %}{% endblock javascripts %}
	
</body>
</html>